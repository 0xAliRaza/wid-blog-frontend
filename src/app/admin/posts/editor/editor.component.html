<nav id="editor-top-nav" class="navbar navbar-expand">

    <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link posts-link" routerLink="/admin/post">
                <svg-icon icon="chevron-left" class="mr-1"></svg-icon>Posts
            </a>
        </li>
        <li class="nav-item">
            <span class="navbar-text">
                {{this.postStatus | titlecase}}
            </span>
        </li>
        <li *ngIf="wordCount && +wordCount.characters > 0" class="nav-item">
            <span class="navbar-text text-secondary">
                characters: {{wordCount.characters}}
            </span>
            <span class="navbar-text text-secondary">
                words: {{wordCount.words}}
            </span>
        </li>
    </ul>
    <ul class="navbar-nav">

        <li class="nav-item submit-toggle" #submitMenu>
            <button appToggler #toggler="appToggler" [excluded]="submitMenu"
                class="btn nav-link submit-toggle__btn">Submit <svg-icon icon="chevron-down" class="ml-1"></svg-icon>
            </button>
            <div *ngIf="toggler.visible" class="shadow submit-toggle__content">
                <p class="font-weight-bold mx-2">Post status</p>
                <div class="my-3 px-2">
                    <div class="custom-control custom-checkbox mb-2">
                        <input id="published" (input)="onTypeChange(true)" class="custom-control-input" type="checkbox"
                            [checked]="f.published.value">
                        <label class="custom-control-label" for="published">
                            Published
                        </label>
                    </div>
                    <div class="custom-control custom-checkbox">
                        <input id="draft" (input)="onTypeChange(false)" class="custom-control-input" type="checkbox"
                            [checked]="!f.published.value">
                        <label class="custom-control-label" for="draft">
                            Draft
                        </label>
                    </div>
                </div>
                <div class="mb-1 d-flex justify-content-center">
                    <button class="btn btn-sm btn-outline-danger my-2 mr-2" (click)="toggler.toggle()">Cancel</button>
                    <button class="btn btn-sm btn-success my-2" (click)="toggler.toggle();onSubmit()">Submit</button>
                </div>

            </div>

        </li>
        <li class="nav-item">
            <button class="nav-link btn settings-btn" (click)="toggleSideNav()">
                <svg-icon icon="settings"></svg-icon>
            </button>
        </li>
    </ul>
</nav>

<div class="container">
    <div class="row justify-content-center">
        <div class="post col-md-10 col-lg-8 my-5 py-5">
            <div class="post__form">
                <form [formGroup]="postForm">
                    <div class="post__title">
                        <input placeholder="Post Title" class="post__title-input" formControlName="title">
                    </div>
                    <div class="post__text">
                        <editor (onKeyUp)="onTinymceChange()" (onInit)="onTinymceInit($event)" [init]="tinymceConfig"
                            id="tinymce-editor"></editor>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<aside class="sidebar" @slideInOut *ngIf="isSideNavOpen">
    <div class="sidebar__top-intro">
        <h4 class="sidebar__top-intro-heading">Post settings</h4>
        <button class="sidebar__close-button btn" (click)="toggleSideNav()">
            <svg-icon icon="close"></svg-icon>
        </button>
    </div>
    <div class="sidebar__form">
        <form enctype="multipart/form-data" [formGroup]="postForm">
            <div class="form-group">
                <label for="post-featured-image">Featured Image</label>
                <input #featuredImage type="file" accept="image/*" id="post-featured-image" class="form-control-file"
                    (change)="onFeaturedImageChange($event)">
                <div class="featured-image-thumb" *ngIf="featuredImageUrl">
                    <img [src]="featuredImageUrl" alt="" class="img-fluid img-thumbnail my-1">
                    <button (click)="removeFeaturedImage($event)" class="btn btn-sm btn-danger">Delete</button>
                </div>
            </div>
            <div class="form-group">
                <label for="post-url">URL</label>
                <input type="text" id="post-url" class="form-control" formControlName="slug"
                    [value]="f.slug.value | slugify">
            </div>
            <div class="form-group" *ngIf="post.exists">
                <label for="post-published-at">Published at</label>
                <input  type="datetime-local" class="form-control" id="post-published-at" (input)="onPublishedAtChange($event)" [value]="f.published_at.value | date:'yyyy-MM-ddTHH:mm'">
            </div>
            <div class="form-group">
                <label for="post-tags">Tags</label>
                <ng-select *ngIf="ngSelectTagCreator" placeholder="Select or create tags..." labelForId="post-tags"
                    [items]="tags" [multiple]="true" [addTag]="ngSelectTagCreator.bind(this)" bindLabel="name"
                    formControlName="tags" [virtualScroll]="true">
                </ng-select>

            </div>
            
            <div class="form-group">
                <label for="post-excerpt">Custom excerpt</label>
                <textarea rows="3" type="text" id="post-excerpt" class="form-control"
                    formControlName="custom_excerpt"></textarea>
            </div>
            <div class="form-group">
                <label for="post-meta-title">Meta Title</label>
                <input type="text" id="post-meta-title" class="form-control" formControlName="meta_title">
            </div>
            <div class="form-group">
                <label for="post-meta-description">Meta description</label>
                <textarea rows="3" type="text" id="post-meta-description" class="form-control"
                    formControlName="meta_description"></textarea>
            </div>
            <div class="custom-control custom-checkbox">
                <input type="checkbox" id="post-featured" class="custom-control-input" formControlName="featured">
                <label for="post-featured" class="custom-control-label">Featured</label>
            </div>
        </form>
    </div>
    <div class="sidebar__delete-post">
        <button [disabled]="!post.exists" (click)="onDelete()" class="btn btn-outline-danger sidebar__delete-post-btn">
            <svg-icon icon="trash"></svg-icon>
            <span>Delete Post</span>
        </button>
    </div>
</aside>